import{a as i}from"./authGuard-BZN1f7iU.js";import{t as c}from"./toggleVisibilityOfElements-BjvdhEGM.js";import{getPostId as l}from"./post-DyVdCQck.js";import{c as m,h as u}from"./headers-CFI2SWSJ.js";import{a as f}from"./read-CK2vkzDB.js";async function p(e,{title:t,body:r}){try{const o=await fetch(`${m}/${e}`,{method:"PUT",headers:u(),body:JSON.stringify({title:t,body:r})});if(!o.ok){const s=await o.json();throw console.error("Error response data:",s),new Error("Failed to update the post")}return await o.json()}catch(o){throw console.error("Error in updatePost:",o),o}}async function y(e){e.preventDefault();const t=new URLSearchParams(window.location.search).get("id"),r=new FormData(e.target),o={title:r.get("title"),body:r.get("body")};try{const a=p(t,o);alert("Post updated successfully!"),window.location.href=`/post/?id=${t}`}catch(a){console.error("Error updating post:",a),alert("Failed to update post.")}}c();i();async function g(){const e=l();if(!e){alert("No post ID found.");return}try{const t=await f(e),r=document.getElementById("title"),o=document.getElementById("body"),a=document.getElementById("tags"),s=document.getElementById("mediaUrl"),n=document.getElementById("mediaAlt");r&&(r.value=t.title||""),o&&(o.value=t.body||""),a&&(a.value=t.tags?.join(", ")||""),s&&(s.value=t.media?.url||""),n&&(n.value=t.media?.alt||"");const d=document.getElementById("editPostForm");d&&d.setAttribute("data-post-id",e)}catch(t){console.error("Error loading post:",t),alert("Failed to load post data.")}}g();const h=document.forms.editPost;h.addEventListener("submit",y);
