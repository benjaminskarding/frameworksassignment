import{A as c,h as s,a as g}from"./headers-CFI2SWSJ.js";async function l(){try{const e=await fetch(c,{method:"POST",headers:s()});if(!e.ok)throw new Error(`Failed to generate API key. Status: ${e.status}`);return(await e.json()).data.key}catch(e){throw console.error("Error creating API key:",e),e}}async function d({email:e,password:o}){try{const t=await fetch(g,{method:"POST",headers:s(),body:JSON.stringify({email:e,password:o})}),a=await t.json();if(!t.ok)throw new Error(a.message||"Login failed:");return a}catch(t){throw console.error("Error Details:",t),new Error(t.message||"Something went wrong during login")}}async function m(e){e.preventDefault();const o=new FormData(e.target),t={email:o.get("email"),password:o.get("password")};try{const a=await d(t),n=a.data.accessToken,i=a.data.name;localStorage.setItem("accessToken",n),localStorage.setItem("name",i);let r=localStorage.getItem(`${t.email}_userApiKey`);r||(r=await l(n),localStorage.setItem(`${t.email}_userApiKey`,r)),alert("Logged in and API key created! Taking you to feed page..."),setTimeout(()=>{window.location.href="/"},2e3)}catch(a){console.error("Login failed:",a)}}const w=document.forms.login;w.addEventListener("submit",m);
