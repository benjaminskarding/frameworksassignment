import{t as u}from"./toggleVisibilityOfElements-BjvdhEGM.js";import{a as g}from"./read-lb79siKI.js";import{g as p}from"./authGuard-BZN1f7iU.js";import{b as f,c as y}from"./headers-BmPhY2IE.js";async function E(o){if(!localStorage.getItem("accessToken"))throw console.error("No access token found"),new Error("No access token found. Please log in");try{const e=await fetch(`${f}/${o}`,{method:"DELETE",headers:y()});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to delete post")}return console.log("Post successfully deleted"),!0}catch(e){throw console.error("Error deleting post",e),new Error(e.message||"An error occurred while deleting the post")}}async function h(o){const n=l();if(confirm("Are you sure you want to delete this post?"))try{await E(n),alert("Post deleted"),window.location.href="/"}catch{console.error("Error deleting post"),alert("Failed to delete post")}}function l(){return new URLSearchParams(window.location.search).get("id")}async function w(){const o=l(),n=p(),e=!!n;if(!o){alert("No post ID found.");return}try{const t=await g(o);if(t){const s=document.getElementById("postTitle");s&&(s.textContent=t.title||"Untitled");const a=document.getElementById("postAuthor");a&&(a.textContent=`Author: ${t.author?.name||"Unknown"}`);const d=document.getElementById("postBody");d&&(d.textContent=t.body||"No content available");const c=document.getElementById("postTags");if(c&&t.tags&&t.tags.length>0){const m=t.tags.join(", ");c.textContent=`Tags: ${m}`}const r=document.getElementById("postMedia");r&&(t.media&&t.media.url?(r.src=t.media.url,r.alt=t.media.alt||"Post media",r.style.display="block"):r.style.display="none");const i=t.author?.name===n;u(e,i),document.getElementById("updatePostButton").addEventListener("click",function(){window.location.href=`/post/edit/?id=${o}`})}else alert("Post not found.")}catch(t){console.error("Error loading post:",t);const s=document.getElementById("postBody");s&&(s.textContent="Failed to load post.")}}w();document.getElementById("deletePostButton").addEventListener("click",async()=>{await h()});export{l as getPostId};
